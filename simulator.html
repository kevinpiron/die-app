<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#0d0d14">
<title>die App</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
  background:linear-gradient(135deg,#0d0d1a,#1a0a2e);
  min-height:100vh;display:flex;justify-content:center;align-items:center;
  font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;
  -webkit-user-select:none;user-select:none;
}

/* â”€â”€ Phone Frame (Desktop) â”€â”€ */
.phone{
  width:390px;height:844px;background:#000;border-radius:52px;padding:14px;
  box-shadow:0 0 0 2px #222,0 40px 120px rgba(0,0,0,0.95),inset 0 0 0 1px #444;
  position:relative;flex-shrink:0;
}
.screen{
  width:100%;height:100%;background:#0d0d14;border-radius:40px;
  overflow:hidden;display:flex;flex-direction:column;position:relative;
}
.status-bar{
  background:#0d0d14;padding:16px 24px 6px;
  display:flex;justify-content:space-between;
  font-size:13px;font-weight:600;color:#fff;flex-shrink:0;
}

/* â”€â”€ Mobile Fullscreen â”€â”€ */
@media (max-width:500px){
  body{background:#0d0d14;align-items:stretch;}
  .phone{
    width:100%;height:100vh;height:100dvh;
    border-radius:0;padding:0;
    box-shadow:none;
    position:fixed;inset:0;
  }
  .screen{border-radius:0;}
  .full-layer{border-radius:0!important;}
  .status-bar{padding:env(safe-area-inset-top,16px) 24px 6px;}
  .tabs{padding-bottom:max(22px,env(safe-area-inset-bottom));}
}
.content{flex:1;overflow-y:auto;overflow-x:hidden;padding-bottom:8px;}
.content::-webkit-scrollbar{display:none;}

/* â”€â”€ Tab Bar â”€â”€ */
.tabs{
  background:rgba(13,13,20,0.97);border-top:1px solid rgba(255,255,255,0.07);
  display:flex;padding:8px 0 22px;flex-shrink:0;
}
.tab{
  flex:1;display:flex;flex-direction:column;align-items:center;gap:3px;
  cursor:pointer;border:none;background:none;padding:4px 2px;
}
.tab .ico{font-size:22px;}
.tab .lbl{font-size:10px;font-weight:500;}
.tab.active .lbl,.tab.active .ico{color:#8b5cf6;}
.tab:not(.active) .lbl,.tab:not(.active) .ico{color:rgba(255,255,255,0.3);}

/* â”€â”€ Cards â”€â”€ */
.card{
  background:#16161f;border-radius:16px;margin:0 16px 12px;
  border:1px solid rgba(255,255,255,0.06);overflow:hidden;
}
.card-p{padding:16px;}
.card2{background:#1c1c28;border-radius:16px;margin:0 16px 12px;
  border:1px solid rgba(255,255,255,0.05);overflow:hidden;}
.card2-p{padding:16px;}
.nav-title{font-size:28px;font-weight:800;color:#fff;padding:10px 20px 4px;}

/* â”€â”€ Hero (Punkte) â”€â”€ */
.hero{
  margin:0 16px 12px;border-radius:20px;padding:28px;text-align:center;
  background:linear-gradient(135deg,#8b5cf6,#4338ca);
  box-shadow:0 8px 32px rgba(139,92,246,0.45);
}
.hero-lbl{color:rgba(255,255,255,0.75);font-size:15px;margin-bottom:4px;}
.hero-pts{color:#fff;font-size:70px;font-weight:900;line-height:1;}
.hero-sub{color:rgba(255,255,255,0.65);font-size:13px;margin-top:6px;}

/* â”€â”€ Progress Bar â”€â”€ */
.prog-bg{background:rgba(255,255,255,0.1);border-radius:99px;height:8px;overflow:hidden;margin:8px 0 6px;}
.prog-fill{background:#8b5cf6;height:100%;border-radius:99px;transition:width .5s;}

/* â”€â”€ Goal Row â”€â”€ */
.goal-row{
  display:flex;align-items:center;gap:12px;padding:12px 16px;
  border-bottom:1px solid rgba(255,255,255,0.05);
}
.goal-row:last-child{border-bottom:none;}
.g-ico{width:44px;height:44px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0;}
.g-title{font-size:15px;font-weight:500;color:#fff;}
.g-pts{font-size:12px;color:rgba(255,255,255,0.4);margin-top:1px;}
.g-done .g-title{text-decoration:line-through;color:rgba(255,255,255,0.3);}
.check-btn{background:none;border:none;font-size:28px;cursor:pointer;flex-shrink:0;line-height:1;}

/* â”€â”€ Toggle â”€â”€ */
.tog{position:relative;width:51px;height:31px;flex-shrink:0;}
.tog input{opacity:0;width:0;height:0;position:absolute;}
.tog-track{position:absolute;inset:0;background:rgba(255,255,255,0.1);border-radius:99px;cursor:pointer;transition:.3s;}
.tog-track::before{content:'';position:absolute;width:27px;height:27px;left:2px;top:2px;background:#fff;border-radius:50%;transition:.3s;box-shadow:0 2px 4px rgba(0,0,0,0.4);}
.tog input:checked+.tog-track{background:#8b5cf6;}
.tog input:checked+.tog-track::before{transform:translateX(20px);}

/* â”€â”€ Chips â”€â”€ */
.chip{display:inline-flex;align-items:center;gap:5px;padding:7px 13px;border-radius:99px;font-size:13px;font-weight:500;margin:4px;cursor:pointer;border:none;transition:all .15s;}
.chip-off{background:rgba(255,255,255,0.07);color:rgba(255,255,255,0.6);}
.chip-on{background:#8b5cf6;color:white;}

/* â”€â”€ Minute Buttons â”€â”€ */
.min-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;}
.min-btn{padding:10px 4px;border-radius:12px;border:none;cursor:pointer;font-weight:800;font-size:18px;display:flex;flex-direction:column;align-items:center;transition:all .15s;font-family:inherit;}
.min-btn small{font-size:10px;font-weight:500;margin-top:1px;}
.min-btn.on{background:#8b5cf6;color:white;}
.min-btn.off{background:rgba(255,255,255,0.07);color:rgba(255,255,255,0.7);}
.min-btn.cant{opacity:.3;cursor:default;}

/* â”€â”€ Buttons â”€â”€ */
.btn{width:100%;padding:15px;border-radius:14px;border:none;font-size:16px;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;transition:all .15s;font-family:inherit;}
.btn-purple{background:linear-gradient(135deg,#8b5cf6,#7c3aed);color:white;box-shadow:0 4px 16px rgba(139,92,246,0.35);}
.btn-purple:hover{background:linear-gradient(135deg,#7c3aed,#6d28d9);}
.btn-gray{background:rgba(255,255,255,0.08);color:rgba(255,255,255,0.3);cursor:not-allowed;}
.btn-outline{background:transparent;color:rgba(255,255,255,0.6);border:1px solid rgba(255,255,255,0.12);}
.btn-outline:hover{background:rgba(255,255,255,0.05);}

/* â”€â”€ History â”€â”€ */
.h-row{display:flex;align-items:center;gap:10px;padding:8px 0;border-bottom:1px solid rgba(255,255,255,0.05);font-size:14px;color:#fff;}
.h-row:last-child{border-bottom:none;}

/* â”€â”€ Inputs â”€â”€ */
.inp{width:100%;padding:13px 14px;border:1.5px solid rgba(255,255,255,0.1);border-radius:12px;font-size:16px;outline:none;font-family:inherit;background:rgba(255,255,255,0.05);color:#fff;}
.inp::placeholder{color:rgba(255,255,255,0.25);}
.inp:focus{border-color:#8b5cf6;}

/* â”€â”€ Stepper â”€â”€ */
.stepper{display:flex;align-items:center;gap:16px;}
.step-btn{width:38px;height:38px;border-radius:50%;border:none;background:rgba(139,92,246,0.2);color:#a78bfa;font-size:22px;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center;}

/* â”€â”€ Session Banner â”€â”€ */
.sess-banner{margin:0 16px 12px;background:rgba(249,115,22,0.1);border:1px solid rgba(249,115,22,0.25);border-radius:12px;padding:14px;display:flex;align-items:center;gap:12px;}

/* â”€â”€ Overlays â”€â”€ */
.full-layer{position:absolute;inset:0;border-radius:40px;overflow:hidden;}
.success-ov{background:rgba(0,0,0,0.6);display:flex;align-items:center;justify-content:center;z-index:300;}
.success-card{background:#16161f;border:1px solid rgba(255,255,255,0.08);border-radius:24px;padding:36px 40px;text-align:center;animation:pop .3s ease;}
.sheet-bg{background:rgba(0,0,0,0.5);display:flex;align-items:flex-end;z-index:200;}
.sheet{background:#16161f;border:1px solid rgba(255,255,255,0.08);border-radius:24px 24px 0 0;width:100%;padding:16px 20px 32px;animation:slideUp .3s ease;}
.handle{width:36px;height:4px;background:rgba(255,255,255,0.15);border-radius:99px;margin:0 auto 16px;}

/* â”€â”€ Row utils â”€â”€ */
.row{display:flex;align-items:center;gap:12px;}
.row-sb{display:flex;align-items:center;justify-content:space-between;}

/* â”€â”€ Animations â”€â”€ */
@keyframes pop{from{transform:scale(.8);opacity:0}to{transform:scale(1);opacity:1}}
@keyframes slideUp{from{transform:translateY(100%)}to{transform:translateY(0)}}
@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}

/* â”€â”€ Intro Layer â”€â”€ */
#intro-layer{background:#0a0a0f;}
#intro-question{font-size:27px;font-weight:800;color:#fff;line-height:1.3;letter-spacing:-.5px;transition:opacity .6s ease;}

/* â”€â”€ Stats Layer â”€â”€ */
#stats-layer{
  background:#0a0a0f;overflow-y:auto;overflow-x:hidden;
}
#stats-layer::-webkit-scrollbar{display:none;}

/* Panel geschlossen */
.stat-panel{
  background:#16161f;border:1px solid rgba(255,255,255,0.07);
  border-radius:18px;margin:0 20px 12px;cursor:pointer;
  overflow:hidden;transform-origin:center;
  transition:border-color .2s;
  animation:panelWobble 3.5s ease-in-out infinite;
}
.stat-panel:nth-child(1){animation-delay:0s;}
.stat-panel:nth-child(2){animation-delay:.5s;}
.stat-panel:nth-child(3){animation-delay:1s;}
.stat-panel:nth-child(4){animation-delay:1.5s;}
.stat-panel:nth-child(5){animation-delay:2s;}
.stat-panel.open{animation:none;border-color:rgba(139,92,246,0.4);}
.stat-panel:active{transform:scale(0.97)!important;}

@keyframes panelWobble{
  0%,100%{transform:rotate(0deg) scale(1);}
  20%{transform:rotate(-0.8deg) scale(1.008);}
  50%{transform:rotate(0.8deg) scale(1.008);}
  80%{transform:rotate(-0.4deg) scale(1.003);}
}

/* Panel Header (immer sichtbar) */
.stat-head{
  display:flex;align-items:center;gap:14px;padding:16px 18px;
}
.stat-emoji-wrap{
  width:46px;height:46px;border-radius:14px;
  display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0;
}
.stat-title{font-size:15px;font-weight:700;color:#fff;line-height:1.3;flex:1;}
.stat-arrow{font-size:16px;color:rgba(255,255,255,0.25);transition:transform .3s;flex-shrink:0;}
.stat-panel.open .stat-arrow{transform:rotate(90deg);color:#8b5cf6;}

/* Panel Detail (aufgeklappt) */
.stat-detail{
  display:none;padding:0 18px 18px;border-top:1px solid rgba(255,255,255,0.05);
  animation:fadeIn .25s ease;
}
.stat-panel.open .stat-detail{display:block;}
.stat-num{font-size:40px;font-weight:900;line-height:1;margin:14px 0 8px;}
.stat-txt{font-size:14px;color:rgba(255,255,255,0.6);line-height:1.6;}
.stat-src{font-size:10px;color:rgba(255,255,255,0.2);margin-top:10px;}

/* Tap-Hint */
.tap-hint{font-size:11px;color:rgba(255,255,255,0.2);margin-top:2px;}

/* â”€â”€ Registration Layer â”€â”€ */
#reg-layer{
  background:#0a0a0f;display:flex;flex-direction:column;
  align-items:center;padding:48px 28px 32px;
  animation:fadeIn .4s ease;overflow-y:auto;
}
#reg-layer::-webkit-scrollbar{display:none;}
.auth-tabs{
  display:flex;width:100%;background:rgba(255,255,255,0.05);
  border-radius:12px;padding:3px;margin-bottom:32px;flex-shrink:0;
}
.auth-tab{
  flex:1;padding:11px;border:none;border-radius:9px;font-size:14px;
  font-weight:700;cursor:pointer;transition:all .2s;font-family:inherit;
  background:transparent;color:rgba(255,255,255,0.4);
}
.auth-tab.active{background:#8b5cf6;color:#fff;}
.reg-header{text-align:center;margin-bottom:28px;flex-shrink:0;}
.reg-label{font-size:13px;font-weight:600;color:rgba(255,255,255,0.2);letter-spacing:1.5px;text-transform:uppercase;margin-bottom:10px;}
.reg-logo{font-size:32px;font-weight:900;color:#fff;letter-spacing:-1px;margin-bottom:6px;}
.reg-sub{font-size:14px;color:rgba(255,255,255,0.4);line-height:1.5;}
.social-btn{
  width:100%;padding:15px 20px;border-radius:14px;border:1px solid rgba(255,255,255,0.1);
  background:rgba(255,255,255,0.04);color:#fff;font-size:15px;font-weight:600;
  display:flex;align-items:center;gap:14px;cursor:pointer;font-family:inherit;
  transition:all .15s;
}
.social-btn:hover{background:rgba(255,255,255,0.08);border-color:rgba(255,255,255,0.2);}
.social-btns{width:100%;display:flex;flex-direction:column;gap:10px;}
.divider{display:flex;align-items:center;gap:12px;width:100%;margin:18px 0;}
.divider-line{flex:1;height:1px;background:rgba(255,255,255,0.08);}
.divider-txt{font-size:13px;color:rgba(255,255,255,0.3);}
.email-fields{width:100%;display:flex;flex-direction:column;gap:10px;}
.reg-agree{font-size:11px;color:rgba(255,255,255,0.2);text-align:center;margin-top:20px;line-height:1.6;}
.forgot-link{
  background:none;border:none;color:rgba(255,255,255,0.3);
  font-size:13px;cursor:pointer;padding:6px 0;font-family:inherit;
  margin-top:4px;text-align:center;width:100%;
}
.loading-spin{
  width:22px;height:22px;border:2px solid rgba(255,255,255,0.2);
  border-top-color:#fff;border-radius:50%;
  animation:spin .7s linear infinite;display:inline-block;
}
@keyframes spin{to{transform:rotate(360deg)}}
</style>
</head>
<body>
<div class="phone">
<div class="screen" id="screen">

  <!-- â•â• INTRO LAYER â•â• -->
  <div id="intro-layer" class="full-layer" style="z-index:999;">
    <canvas id="intro-canvas" style="position:absolute;inset:0;width:100%;height:100%;"></canvas>
    <div style="position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:space-between;padding:64px 28px 48px;">
      <div style="flex:1;display:flex;align-items:center;justify-content:center;">
        <div id="intro-question" style="text-align:center;"></div>
      </div>
      <div style="width:100%;">
        <button onclick="exitIntro()" class="btn btn-purple" style="font-size:17px;letter-spacing:.2px;padding:18px;">
          Weiter â†’
        </button>
      </div>
    </div>
  </div>

  <!-- â•â• STATS LAYER â•â• -->
  <div id="stats-layer" class="full-layer" style="z-index:998;display:none;">
    <div style="padding:52px 0 0;min-height:100%;display:flex;flex-direction:column;">

      <div style="padding:0 20px 20px;">
        <div style="font-size:12px;font-weight:700;color:#8b5cf6;letter-spacing:1.5px;text-transform:uppercase;margin-bottom:10px;">Wusstest du schon?</div>
        <div style="font-size:24px;font-weight:900;color:#fff;line-height:1.2;margin-bottom:4px;">Was Scrollen mit<br>deinem Gehirn macht.</div>
        <div style="font-size:13px;color:rgba(255,255,255,0.3);margin-top:6px;">Tippe auf eine Karte um mehr zu erfahren.</div>
      </div>

      <!-- Panel 1 -->
      <div class="stat-panel" onclick="toggleStat(this)">
        <div class="stat-head">
          <div style="flex:1">
            <div class="stat-title">Deine Aufmerksamkeit ist kÃ¼rzer als die eines Goldfisches.</div>

          </div>
          <div class="stat-arrow">âŒ„</div>
        </div>
        <div class="stat-detail">
          <div class="stat-num" style="color:#a78bfa;">8 Sek</div>
          <div class="stat-txt">Die durchschnittliche menschliche <strong style="color:#fff">Aufmerksamkeitsspanne</strong> ist seit 2000 von 12 auf 8 Sekunden gesunken â€” kÃ¼rzer als die eines Goldfisches (9 Sek).</div>
          <div class="stat-src">Quelle: Microsoft Studie, 2015</div>
        </div>
      </div>

      <!-- Panel 2 -->
      <div class="stat-panel" onclick="toggleStat(this)">
        <div class="stat-head">
          <div style="flex:1">
            <div class="stat-title">Du schaust Ã¶fter aufs Handy als du denkst.</div>

          </div>
          <div class="stat-arrow">âŒ„</div>
        </div>
        <div class="stat-detail">
          <div class="stat-num" style="color:#f97316;">96Ã—</div>
          <div class="stat-txt">So oft schaut der Durchschnittsmensch tÃ¤glich auf sein Handy â€” das ist <strong style="color:#fff">alle 10 Minuten</strong> einmal, auch nachts.</div>
          <div class="stat-src">Quelle: Asurion Studie, 2019</div>
        </div>
      </div>

      <!-- Panel 3 -->
      <div class="stat-panel" onclick="toggleStat(this)">
        <div class="stat-head">
          <div style="flex:1">
            <div class="stat-title">TikTok frisst mehr als einen ganzen Monat pro Jahr.</div>

          </div>
          <div class="stat-arrow">âŒ„</div>
        </div>
        <div class="stat-detail">
          <div class="stat-num" style="color:#f43f5e;">578 h</div>
          <div class="stat-txt">TikTok-Nutzer verbringen im Schnitt <strong style="color:#fff">95 Minuten tÃ¤glich</strong> in der App â€” das sind Ã¼ber 578 Stunden im Jahr. Mehr als 24 volle Tage.</div>
          <div class="stat-src">Quelle: Data.ai Report, 2022</div>
        </div>
      </div>

      <!-- Panel 4 -->
      <div class="stat-panel" onclick="toggleStat(this)">
        <div class="stat-head">
          <div style="flex:1">
            <div class="stat-title">Weniger scrollen macht dich nachweislich glÃ¼cklicher.</div>

          </div>
          <div class="stat-arrow">âŒ„</div>
        </div>
        <div class="stat-detail">
          <div class="stat-num" style="color:#4ade80;">âˆ’50%</div>
          <div class="stat-txt">Weniger Einsamkeit und Depression bei Menschen, die Social Media auf <strong style="color:#fff">30 Minuten tÃ¤glich begrenzen</strong> â€” bereits nach nur 3 Wochen messbar.</div>
          <div class="stat-src">Quelle: University of Pennsylvania, 2018</div>
        </div>
      </div>

      <!-- Panel 5 -->
      <div class="stat-panel" onclick="toggleStat(this)">
        <div class="stat-head">
          <div style="flex:1">
            <div class="stat-title">Dein Feed funktioniert wie ein Spielautomat.</div>

          </div>
          <div class="stat-arrow">âŒ„</div>
        </div>
        <div class="stat-detail">
          <div class="stat-num" style="color:#fb923c;">Dopamin</div>
          <div class="stat-txt">Jedes Like und jeder neue Post aktiviert das <strong style="color:#fff">Belohnungszentrum</strong> im Gehirn â€” exakt denselben Mechanismus wie beim GlÃ¼cksspiel. Absichtlich so designt.</div>
          <div class="stat-src">Quelle: Harvard University</div>
        </div>
      </div>

      <div style="padding:16px 20px 32px;margin-top:8px;">
        <button onclick="exitStats()" class="btn btn-purple" style="font-size:17px;padding:18px;letter-spacing:.2px;">
          Jetzt Ã¤ndern â†’
        </button>
        <div style="text-align:center;margin-top:12px;font-size:10px;color:rgba(255,255,255,0.15);line-height:1.6;">
          Basierend auf wissenschaftlichen Studien &amp; unabhÃ¤ngigen Marktanalysen.
        </div>
      </div>

    </div>
  </div>

  <!-- â•â• USERNAME LAYER â•â• -->
  <div id="username-layer" class="full-layer" style="z-index:997;display:none;background:#0a0a0f;flex-direction:column;align-items:center;justify-content:center;padding:40px 28px;">
    <div style="width:100%;max-width:340px;">
      <div style="font-size:13px;font-weight:600;color:rgba(255,255,255,0.25);letter-spacing:1px;text-transform:uppercase;text-align:center;margin-bottom:24px;">die App</div>
      <div style="font-size:30px;font-weight:900;color:#fff;margin-bottom:8px;text-align:center;">Wie heiÃŸt du?</div>
      <div style="font-size:15px;color:rgba(255,255,255,0.4);text-align:center;margin-bottom:36px;line-height:1.5;">WÃ¤hle einen einzigartigen Nickname.<br>Andere Nutzer finden dich damit.</div>

      <div style="position:relative;margin-bottom:10px;">
        <div style="position:absolute;left:14px;top:50%;transform:translateY(-50%);font-size:16px;color:rgba(255,255,255,0.3);font-weight:600;">@</div>
        <input id="username-input" class="inp" type="text" placeholder="dein_nickname" maxlength="20"
          style="padding-left:32px;font-size:17px;letter-spacing:.2px;text-transform:lowercase;"
          oninput="checkUsername(this.value)">
      </div>

      <div id="username-status" style="font-size:13px;min-height:20px;margin-bottom:20px;padding:0 4px;transition:all .2s;"></div>

      <div style="font-size:12px;color:rgba(255,255,255,0.2);margin-bottom:24px;line-height:1.6;">
        3â€“20 Zeichen Â· Nur Buchstaben, Zahlen & _ Â· Wird automatisch kleingeschrieben
      </div>

      <button id="username-btn" class="btn btn-gray" onclick="confirmUsername()" disabled style="font-size:16px;">
        Weiter â†’
      </button>
    </div>
  </div>

  <!-- â•â• REGISTRATION LAYER â•â• -->
  <div id="reg-layer" class="full-layer" style="z-index:998;display:none;">

    <!-- Tab Toggle -->
    <div class="auth-tabs">
      <button id="tab-register" class="auth-tab active" onclick="switchAuthTab('register')">Registrieren</button>
      <button id="tab-login" class="auth-tab" onclick="switchAuthTab('login')">Anmelden</button>
    </div>

    <!-- REGISTER VIEW -->
    <div id="view-register" style="width:100%;display:flex;flex-direction:column;align-items:center;">
      <div class="reg-header">
        <div class="reg-label">die App</div>
        <div class="reg-logo">Werde frei.</div>
        <div class="reg-sub">Verdiene dir deine Bildschirmzeit.<br>Jeden. Tag. Neu.</div>
      </div>

      <div class="social-btns">
        <button class="social-btn" onclick="simulateLogin('apple')">
          <svg width="20" height="20" viewBox="0 0 22 22" fill="none"><path d="M16.5 11.55c-.02-2.1 1.71-3.12 1.79-3.17-0.98-1.43-2.5-1.63-3.04-1.65-1.3-.13-2.53.76-3.19.76-.66 0-1.69-.74-2.78-.72-1.43.02-2.75.84-3.49 2.12-1.49 2.58-.38 6.4 1.07 8.5.71 1.02 1.56 2.17 2.68 2.13 1.07-.04 1.48-.69 2.77-.69 1.3 0 1.66.69 2.79.67 1.15-.02 1.89-1.05 2.6-2.07.82-1.18 1.16-2.33 1.18-2.39-.03-.01-2.27-.87-2.34-3.49z" fill="#fff"/><path d="M14.3 5.3c.59-.72 1-1.71.89-2.7-.86.04-1.9.58-2.52 1.29-.55.64-.97 1.65-.85 2.62.96.07 1.93-.48 2.48-1.21z" fill="#fff"/></svg>
          Mit Apple registrieren
        </button>
        <button class="social-btn" onclick="simulateLogin('google')">
          <svg width="20" height="20" viewBox="0 0 22 22"><path d="M21.6 11.25c0-.79-.07-1.55-.2-2.27H11v4.3h5.94c-.26 1.37-1.04 2.53-2.21 3.31v2.75h3.58c2.09-1.93 3.3-4.77 3.3-8.09z" fill="#4285F4"/><path d="M11 22c2.97 0 5.46-1 7.28-2.66l-3.57-2.77c-.99.66-2.26 1.06-3.71 1.06-2.86 0-5.28-1.93-6.15-4.53H1.17v2.86C2.98 19.49 6.73 22 11 22z" fill="#34A853"/><path d="M4.85 13.1A6.5 6.5 0 0 1 4.5 11c0-.73.13-1.44.35-2.1V6.04H1.17A10.99 10.99 0 0 0 0 11c0 1.78.43 3.46 1.17 4.96l3.68-2.86z" fill="#FBBC05"/><path d="M11 4.37c1.62 0 3.06.56 4.2 1.65l3.15-3.15C16.46 1.09 13.97 0 11 0 6.73 0 2.98 2.51 1.17 6.04l3.68 2.86C5.72 6.3 8.14 4.37 11 4.37z" fill="#EA4335"/></svg>
          Mit Google registrieren
        </button>
      </div>

      <div class="divider"><div class="divider-line"></div><div class="divider-txt">oder</div><div class="divider-line"></div></div>

      <div class="email-fields">
        <input class="inp" type="text"     placeholder="Name"     id="reg-name">
        <input class="inp" type="email"    placeholder="E-Mail"   id="reg-email">
        <input class="inp" type="password" placeholder="Passwort" id="reg-pass">
        <button class="btn btn-purple" onclick="simulateLogin('email')" style="margin-top:6px;">Konto erstellen</button>
      </div>

      <div class="reg-agree">
        Mit der Registrierung stimmst du unseren<br>
        <span style="color:rgba(255,255,255,0.45);">Nutzungsbedingungen</span> &
        <span style="color:rgba(255,255,255,0.45);">Datenschutzrichtlinien</span> zu.
      </div>
    </div>

    <!-- LOGIN VIEW -->
    <div id="view-login" style="width:100%;display:none;flex-direction:column;align-items:center;">
      <div class="reg-header">
        <div class="reg-label">die App</div>
        <div class="reg-logo">Willkommen zurÃ¼ck.</div>
        <div class="reg-sub">Melde dich an und mach weiter<br>wo du aufgehÃ¶rt hast.</div>
      </div>

      <div class="social-btns">
        <button class="social-btn" onclick="simulateLogin('apple')">
          <svg width="20" height="20" viewBox="0 0 22 22" fill="none"><path d="M16.5 11.55c-.02-2.1 1.71-3.12 1.79-3.17-0.98-1.43-2.5-1.63-3.04-1.65-1.3-.13-2.53.76-3.19.76-.66 0-1.69-.74-2.78-.72-1.43.02-2.75.84-3.49 2.12-1.49 2.58-.38 6.4 1.07 8.5.71 1.02 1.56 2.17 2.68 2.13 1.07-.04 1.48-.69 2.77-.69 1.3 0 1.66.69 2.79.67 1.15-.02 1.89-1.05 2.6-2.07.82-1.18 1.16-2.33 1.18-2.39-.03-.01-2.27-.87-2.34-3.49z" fill="#fff"/><path d="M14.3 5.3c.59-.72 1-1.71.89-2.7-.86.04-1.9.58-2.52 1.29-.55.64-.97 1.65-.85 2.62.96.07 1.93-.48 2.48-1.21z" fill="#fff"/></svg>
          Mit Apple anmelden
        </button>
        <button class="social-btn" onclick="simulateLogin('google')">
          <svg width="20" height="20" viewBox="0 0 22 22"><path d="M21.6 11.25c0-.79-.07-1.55-.2-2.27H11v4.3h5.94c-.26 1.37-1.04 2.53-2.21 3.31v2.75h3.58c2.09-1.93 3.3-4.77 3.3-8.09z" fill="#4285F4"/><path d="M11 22c2.97 0 5.46-1 7.28-2.66l-3.57-2.77c-.99.66-2.26 1.06-3.71 1.06-2.86 0-5.28-1.93-6.15-4.53H1.17v2.86C2.98 19.49 6.73 22 11 22z" fill="#34A853"/><path d="M4.85 13.1A6.5 6.5 0 0 1 4.5 11c0-.73.13-1.44.35-2.1V6.04H1.17A10.99 10.99 0 0 0 0 11c0 1.78.43 3.46 1.17 4.96l3.68-2.86z" fill="#FBBC05"/><path d="M11 4.37c1.62 0 3.06.56 4.2 1.65l3.15-3.15C16.46 1.09 13.97 0 11 0 6.73 0 2.98 2.51 1.17 6.04l3.68 2.86C5.72 6.3 8.14 4.37 11 4.37z" fill="#EA4335"/></svg>
          Mit Google anmelden
        </button>
      </div>

      <div class="divider"><div class="divider-line"></div><div class="divider-txt">oder</div><div class="divider-line"></div></div>

      <div class="email-fields">
        <input class="inp" type="email"    placeholder="E-Mail"   id="login-email">
        <input class="inp" type="password" placeholder="Passwort" id="login-pass">
        <button class="btn btn-purple" onclick="simulateLogin('email')" style="margin-top:6px;">Anmelden</button>
        <button class="forgot-link">Passwort vergessen?</button>
      </div>
    </div>

  </div>

  <!-- â•â• MAIN APP â•â• -->
  <div class="status-bar"><span>9:41</span><span style="font-size:12px;">â—â—â—â—â— ğŸ”‹</span></div>
  <div class="content" id="content"></div>
  <div class="tabs"   id="tabs"></div>

</div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const state = {
  screen: 'intro',   // intro | registration | app
  tab: 'home',
  points: 0,
  goals: [
    {id:1,title:'Sport machen',        pts:30,icon:'ğŸƒ',done:false},
    {id:2,title:'Zimmer aufrÃ¤umen',    pts:20,icon:'ğŸ ',done:false},
    {id:3,title:'30 Min lesen',        pts:25,icon:'ğŸ“š',done:false},
    {id:4,title:'Ausreichend Wasser',  pts:10,icon:'ğŸ’§',done:false},
  ],
  history: [],
  blockedApps: [],
  isBlocking: false,
  selectedMin: 10,
  sessionMin: 0,
  showSuccess: false,
  showAddGoal: false,
  addGoalTitle: '',
  addGoalPts: 20,
  addGoalIcon: 'â­',
  nextId: 5,
  sessionTimer: null,
  user: null,
};

const APPS = [
  {id:'instagram',name:'Instagram',icon:'ğŸ“·'},
  {id:'tiktok',   name:'TikTok',   icon:'ğŸµ'},
  {id:'twitter',  name:'Twitter/X',icon:'ğŸ¦'},
  {id:'youtube',  name:'YouTube',  icon:'â–¶ï¸'},
  {id:'snapchat', name:'Snapchat', icon:'ğŸ‘»'},
  {id:'reddit',   name:'Reddit',   icon:'ğŸ¤–'},
];
const ICONS = ['ğŸƒ','ğŸ ','ğŸ“š','ğŸ’§','â¤ï¸','â­','ğŸ¯','ğŸ§¹','ğŸ','ğŸ˜´','ğŸ’ª','ğŸ®'];
const MINS  = [5,10,15,20,30,45,60];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function addHistory(amount, reason, type) {
  state.history.unshift({id:Date.now(),amount,reason,type});
}
function completeGoal(id) {
  const g = state.goals.find(x=>x.id===id);
  if(!g||g.done) return;
  g.done=true;
  state.points+=g.pts;
  addHistory(g.pts,`Ziel erfÃ¼llt: ${g.title}`,'earned');
  render();
}
function toggleApp(id) {
  if(state.blockedApps.includes(id)) state.blockedApps=state.blockedApps.filter(a=>a!==id);
  else state.blockedApps.push(id);
  if(state.blockedApps.length===0) state.isBlocking=false;
  render();
}
function redeem() {
  if(state.points<state.selectedMin) return;
  state.points-=state.selectedMin;
  addHistory(state.selectedMin,`Apps fÃ¼r ${state.selectedMin} Min freigeschaltet`,'redeemed');
  state.isBlocking=false;
  state.sessionMin=state.selectedMin;
  state.showSuccess=true;
  clearTimeout(state.sessionTimer);
  state.sessionTimer=setTimeout(()=>{
    state.sessionMin=0;
    if(state.blockedApps.length>0) state.isBlocking=true;
    render();
  },state.selectedMin*60000);
  render();
  setTimeout(()=>{state.showSuccess=false;render();},2500);
}
function addGoal() {
  if(!state.addGoalTitle.trim()) return;
  state.goals.push({id:state.nextId++,title:state.addGoalTitle,pts:state.addGoalPts,icon:state.addGoalIcon,done:false});
  state.showAddGoal=false; state.addGoalTitle=''; state.addGoalPts=20;
  render();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  REGISTRATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function switchAuthTab(tab) {
  const isReg = tab === 'register';
  document.getElementById('view-register').style.display = isReg ? 'flex' : 'none';
  document.getElementById('view-login').style.display    = isReg ? 'none' : 'flex';
  document.getElementById('tab-register').className = 'auth-tab' + (isReg ? ' active' : '');
  document.getElementById('tab-login').className    = 'auth-tab' + (isReg ? '' : ' active');
}

function toggleStat(panel) {
  const isOpen = panel.classList.contains('open');
  // Alle anderen schlieÃŸen
  document.querySelectorAll('.stat-panel.open').forEach(p => p.classList.remove('open'));
  if (!isOpen) panel.classList.add('open');
}

function toggleEmailForm() {
  const form = document.getElementById('email-form');
  form.classList.toggle('open');
}

// Simulierte bestehende Usernames (fÃ¼r Einzigartigkeit-Check)
const TAKEN_USERNAMES = new Set(['admin','dieapp','support','kevin','max','lisa','test','user']);

// Gesperrte WÃ¶rter (sexuell / Beleidigungen) â€” DE + EN
const BLOCKED_WORDS = [
  // Deutsch â€“ sexuell
  'sex','porno','porn','penis','vagina','ficken','fick','wichsen','wichser',
  'hure','nutte','schlampe','titten','arsch','arschloch','schwanz','fotze',
  // Deutsch â€“ Beleidigungen
  'idiot','vollidiot','depp','trottel','dummkopf','blÃ¶dmann','wichser',
  'hurensohn','bastard','scheiÃŸ','scheiÃŸe','nazi','spast','mongo',
  // Englisch â€“ sexuell
  'fuck','shit','ass','bitch','cock','dick','pussy','cunt','whore','slut',
  'boobs','tits','cum','anal','blowjob','handjob','dildo','nude','naked',
  // Englisch â€“ Beleidigungen
  'nigger','faggot','retard','loser','moron','stupid','idiot','asshole',
  'douchebag','scumbag','bastard','racist','hate',
];

function isBlocked(name) {
  return BLOCKED_WORDS.some(w => name.includes(w));
}

function simulateLogin(method) {
  const regLayer = document.getElementById('reg-layer');
  const emailName = document.getElementById('reg-name')?.value || '';

  regLayer.innerHTML = `
    <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;gap:20px;">
      <div class="loading-spin" style="width:36px;height:36px;border-width:3px;"></div>
      <div style="color:rgba(255,255,255,0.5);font-size:15px;">Wird angemeldetâ€¦</div>
    </div>`;

  setTimeout(()=>{
    state.user = { method, emailName };
    regLayer.style.opacity='0';
    regLayer.style.transition='opacity .4s ease';
    setTimeout(()=>{
      regLayer.style.display='none';
      // Jetzt Username-Screen zeigen
      const ul = document.getElementById('username-layer');
      ul.style.display='flex';
      ul.style.animation='fadeIn .4s ease';
      document.getElementById('username-input').focus();
    },400);
  },1400);
}

let usernameCheckTimer = null;

function checkUsername(val) {
  const clean = val.toLowerCase().replace(/[^a-z0-9_]/g,'');
  const input = document.getElementById('username-input');
  const status = document.getElementById('username-status');
  const btn = document.getElementById('username-btn');

  // Auto-lowercase display
  if(input.value !== clean) input.value = clean;

  btn.disabled = true;
  btn.className = 'btn btn-gray';

  if(clean.length === 0) { status.innerHTML=''; return; }

  if(clean.length < 3) {
    status.innerHTML = '<span style="color:#f87171">âš  Mindestens 3 Zeichen</span>';
    return;
  }

  status.innerHTML = '<span style="color:rgba(255,255,255,0.35)">â³ Wird geprÃ¼ftâ€¦</span>';

  clearTimeout(usernameCheckTimer);
  usernameCheckTimer = setTimeout(()=>{
    if(isBlocked(clean)) {
      status.innerHTML = `<span style="color:#f87171">âœ— Dieser Name ist nicht erlaubt</span>`;
    } else if(TAKEN_USERNAMES.has(clean)) {
      status.innerHTML = `<span style="color:#f87171">âœ— @${clean} ist leider schon vergeben</span>`;
    } else {
      status.innerHTML = `<span style="color:#4ade80">âœ“ @${clean} ist verfÃ¼gbar!</span>`;
      btn.disabled = false;
      btn.className = 'btn btn-purple';
    }
  }, 700);
}

function confirmUsername() {
  const username = document.getElementById('username-input').value;
  if(!username || username.length < 3) return;

  TAKEN_USERNAMES.add(username); // "in DB speichern" (Simulation)
  state.user.username = username;
  state.user.name = username;

  const ul = document.getElementById('username-layer');
  ul.style.transition = 'opacity .4s ease';
  ul.style.opacity = '0';
  setTimeout(()=>{ ul.style.display='none'; state.screen='app'; render(); },400);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  MAIN RENDER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function render() {
  renderTabs();
  renderContent();
  renderOverlays();
}

function renderTabs() {
  const tabs=[
    {id:'home',  ico:'ğŸ ',lbl:'Home'},
    {id:'goals', ico:'âœ…',lbl:'Ziele'},
    {id:'apps',  ico:'ğŸ”’',lbl:'Apps'},
    {id:'redeem',ico:'â³',lbl:'EinlÃ¶sen'},
  ];
  document.getElementById('tabs').innerHTML=tabs.map(t=>`
    <button class="tab ${state.tab===t.id?'active':''}" onclick="state.tab='${t.id}';render()">
      <span class="ico">${t.ico}</span>
      <span class="lbl">${t.lbl}</span>
    </button>`).join('');
}

function renderContent() {
  const el=document.getElementById('content');
  if(state.tab==='home')   el.innerHTML=renderHome();
  if(state.tab==='goals')  el.innerHTML=renderGoals();
  if(state.tab==='apps')   el.innerHTML=renderApps();
  if(state.tab==='redeem') el.innerHTML=renderRedeem();
  const inp=document.getElementById('goal-input');
  if(inp){inp.value=state.addGoalTitle;inp.oninput=e=>{state.addGoalTitle=e.target.value;};inp.focus();}
}

// â”€â”€ HOME â”€â”€
function renderHome() {
  const done=state.goals.filter(g=>g.done).length;
  const total=state.goals.length;
  const prog=total?done/total:0;
  const todayPts=state.history.filter(h=>h.type==='earned').reduce((s,h)=>s+h.amount,0);
  const recent=state.history.slice(0,5);
  const username = state.user?.name ? `@${state.user.name}` : '';

  return `
  <div class="nav-title">die App</div>

  ${username ? `
  <div style="text-align:center;padding:18px 20px 4px;">
    <div style="font-size:13px;color:rgba(255,255,255,0.35);font-weight:500;margin-bottom:6px;">Willkommen zurÃ¼ck</div>
    <div style="font-size:26px;font-weight:800;color:#fff;letter-spacing:-0.5px;">${username}</div>
  </div>` : ''}

  <div class="hero">
    <div class="hero-lbl">Deine Punkte</div>
    <div class="hero-pts">${state.points}</div>
    <div class="hero-sub">= ${state.points} Minuten verfÃ¼gbar</div>
  </div>

  ${state.sessionMin>0?`
  <div class="sess-banner">
    <span style="font-size:24px">â³</span>
    <div>
      <div style="font-weight:600;color:#fff">Aktive Session</div>
      <div style="font-size:13px;color:rgba(249,115,22,.9)">${state.sessionMin} Minuten verbleibend</div>
    </div>
    <div style="margin-left:auto;width:10px;height:10px;border-radius:50%;background:#f97316;box-shadow:0 0 8px #f97316;"></div>
  </div>`:''}

  <div class="card2 card2-p">
    <div class="row-sb" style="margin-bottom:10px">
      <span style="font-weight:600;color:#fff;font-size:16px">Heute</span>
      <span style="color:#a78bfa;font-weight:700">+${todayPts} Punkte</span>
    </div>
    <div class="prog-bg"><div class="prog-fill" style="width:${prog*100}%"></div></div>
    <div style="font-size:13px;color:rgba(255,255,255,0.35);margin-top:6px">${done} von ${total} Zielen erledigt</div>
  </div>

  <div class="card2 card2-p">
    <div class="row" style="gap:14px">
      <span style="font-size:26px">${state.isBlocking?'ğŸ”’':'ğŸ”“'}</span>
      <div>
        <div style="font-weight:600;color:#fff">${state.isBlocking?'Apps gesperrt':'Apps freigegeben'}</div>
        <div style="font-size:13px;color:rgba(255,255,255,0.35)">${state.isBlocking?'Verdiene Punkte um Zeit freizuschalten':'GenieÃŸe deine Zeit bewusst'}</div>
      </div>
    </div>
  </div>

  ${recent.length?`
  <div class="card2 card2-p">
    <div style="font-weight:600;color:#fff;margin-bottom:10px">Letzte AktivitÃ¤t</div>
    ${recent.map(h=>`
    <div class="h-row">
      <span>${h.type==='earned'?'ğŸŸ¢':'ğŸŸ '}</span>
      <span style="flex:1;color:rgba(255,255,255,0.7)">${h.reason}</span>
      <span style="font-weight:700;color:${h.type==='earned'?'#4ade80':'#fb923c'}">${h.type==='earned'?'+':'-'}${h.amount}</span>
    </div>`).join('')}
  </div>`:''}`;
}

// â”€â”€ GOALS â”€â”€
function renderGoals() {
  return `
  <div style="display:flex;align-items:center;justify-content:space-between">
    <div class="nav-title">Ziele</div>
    <button onclick="state.showAddGoal=true;render()" style="background:none;border:none;font-size:30px;color:#8b5cf6;cursor:pointer;padding:8px 20px 0 0;line-height:1">+</button>
  </div>
  <div class="card">
    ${state.goals.map(g=>`
    <div class="goal-row ${g.done?'g-done':''}">
      <div class="g-ico" style="background:${g.done?'rgba(139,92,246,.15)':'rgba(255,255,255,.06)'}">${g.icon}</div>
      <div style="flex:1">
        <div class="g-title">${g.title}</div>
        <div class="g-pts">â­ +${g.pts} Punkte</div>
      </div>
      <button class="check-btn" onclick="completeGoal(${g.id})">${g.done?'âœ…':'â­•'}</button>
    </div>`).join('')}
  </div>
  <div style="margin:0 16px">
    <button class="btn btn-outline" onclick="state.goals.forEach(g=>{g.done=false});render()">ğŸ”„ Alle zurÃ¼cksetzen</button>
  </div>

  ${state.showAddGoal?`
  <div class="sheet-bg full-layer" onclick="state.showAddGoal=false;render()">
    <div class="sheet" onclick="event.stopPropagation()">
      <div class="handle"></div>
      <div style="font-weight:800;font-size:20px;color:#fff;margin-bottom:16px">Neues Ziel</div>
      <div style="margin-bottom:14px">
        <div style="font-size:13px;color:rgba(255,255,255,0.4);margin-bottom:6px">Titel</div>
        <input id="goal-input" class="inp" placeholder="z.B. Joggen gehen">
      </div>
      <div style="margin-bottom:14px">
        <div style="font-size:13px;color:rgba(255,255,255,0.4);margin-bottom:8px">Icon</div>
        <div style="display:flex;flex-wrap:wrap;gap:6px">
          ${ICONS.map(i=>`
          <button onclick="state.addGoalIcon='${i}';render()" style="font-size:22px;width:42px;height:42px;border-radius:10px;cursor:pointer;border:${state.addGoalIcon===i?'2px solid #8b5cf6':'2px solid transparent'};background:${state.addGoalIcon===i?'rgba(139,92,246,.2)':'rgba(255,255,255,.05)'}">${i}</button>`).join('')}
        </div>
      </div>
      <div style="margin-bottom:20px">
        <div style="font-size:13px;color:rgba(255,255,255,0.4);margin-bottom:8px">Punkte: ${state.addGoalPts}</div>
        <div class="stepper">
          <button class="step-btn" onclick="state.addGoalPts=Math.max(5,state.addGoalPts-5);render()">âˆ’</button>
          <div style="flex:1;text-align:center;font-size:22px;font-weight:800;color:#fff">${state.addGoalPts}</div>
          <button class="step-btn" onclick="state.addGoalPts=Math.min(100,state.addGoalPts+5);render()">+</button>
        </div>
      </div>
      <button class="btn btn-purple" onclick="addGoal()">HinzufÃ¼gen</button>
    </div>
  </div>`:''}`;
}

// â”€â”€ APPS â”€â”€
function renderApps() {
  return `
  <div class="nav-title">Apps sperren</div>
  <div class="card2 card2-p">
    <div class="row-sb">
      <div>
        <div style="font-weight:600;color:#fff">${state.isBlocking?'Sperre aktiv ğŸ”’':'Sperre inaktiv ğŸ”“'}</div>
        <div style="font-size:13px;color:rgba(255,255,255,.35)">${state.isBlocking?'AusgewÃ¤hlte Apps sind gesperrt':'Keine Apps werden gesperrt'}</div>
      </div>
      <label class="tog">
        <input type="checkbox" ${state.isBlocking?'checked':''} ${state.blockedApps.length===0?'disabled':''} onchange="state.isBlocking=this.checked;render()">
        <span class="tog-track"></span>
      </label>
    </div>
    ${state.blockedApps.length===0?`<div style="font-size:12px;color:#f87171;margin-top:8px">âš ï¸ WÃ¤hle zuerst Apps aus</div>`:''}
  </div>
  <div class="card card-p">
    <div style="font-weight:600;color:#fff;margin-bottom:12px">Welche Apps sperren?</div>
    <div>
      ${APPS.map(a=>`
      <button class="chip ${state.blockedApps.includes(a.id)?'chip-on':'chip-off'}" onclick="toggleApp('${a.id}')">
        ${a.icon} ${a.name}${state.blockedApps.includes(a.id)?' âœ“':''}
      </button>`).join('')}
    </div>
    ${state.blockedApps.length>0?`<div style="margin-top:12px;font-size:13px;color:#a78bfa;font-weight:600">${state.blockedApps.length} App${state.blockedApps.length>1?'s':''} ausgewÃ¤hlt</div>`:''}
  </div>
  <div class="card2 card2-p" style="border-color:rgba(59,130,246,.2);background:rgba(59,130,246,.05);">
    <div style="font-weight:600;color:#93c5fd;margin-bottom:8px">â„¹ï¸ Wie funktioniert das?</div>
    <div style="font-size:13px;color:rgba(147,197,253,.7);line-height:1.7">
      â€¢ WÃ¤hle Apps die du sperren mÃ¶chtest<br>
      â€¢ Aktiviere die Sperre mit dem Schalter<br>
      â€¢ Erledige Ziele um Punkte zu verdienen<br>
      â€¢ LÃ¶se Punkte ein um Apps freizuschalten
    </div>
  </div>`;
}

// â”€â”€ REDEEM â”€â”€
function renderRedeem() {
  const can=state.points>=state.selectedMin;
  const redeemed=state.history.filter(h=>h.type==='redeemed').slice(0,5);
  return `
  <div class="nav-title">EinlÃ¶sen</div>
  <div style="text-align:center;padding:8px 20px 16px">
    <div style="font-size:14px;color:rgba(255,255,255,.4)">VerfÃ¼gbare Punkte</div>
    <div style="font-size:60px;font-weight:900;color:#a78bfa;line-height:1.1">${state.points}</div>
  </div>
  <div class="card2 card2-p">
    <div style="font-weight:600;color:#fff;margin-bottom:12px">Wie viele Minuten?</div>
    <div class="min-grid">
      ${MINS.map(m=>`
      <button class="min-btn ${state.selectedMin===m?'on':'off'} ${state.points<m&&state.selectedMin!==m?'cant':''}"
        onclick="state.selectedMin=${m};render()">
        ${m}<small>Min</small>
      </button>`).join('')}
    </div>
  </div>
  <div class="card2 card2-p">
    <div class="row-sb">
      <div>
        <div style="font-weight:600;color:#fff">Kosten: ${state.selectedMin} Punkte</div>
        <div style="font-size:13px;color:${can?'rgba(255,255,255,.35)':'#f87171'}">
          ${can?`Danach: ${state.points-state.selectedMin} Punkte Ã¼brig`:`Fehlen: ${state.selectedMin-state.points} Punkte`}
        </div>
      </div>
      <span style="font-size:26px">${can?'âœ…':'âŒ'}</span>
    </div>
  </div>
  <div style="margin:0 16px 16px">
    <button class="btn ${can?'btn-purple':'btn-gray'}" onclick="redeem()">â³ ${state.selectedMin} Minuten freischalten</button>
  </div>
  ${redeemed.length?`
  <div class="card2 card2-p">
    <div style="font-weight:600;color:#fff;margin-bottom:10px">EingelÃ¶ste Sessions</div>
    ${redeemed.map(h=>`
    <div class="h-row">
      <span>â³</span><span style="flex:1;color:rgba(255,255,255,.6)">${h.reason}</span>
      <span style="font-weight:700;color:#fb923c">-${h.amount}</span>
    </div>`).join('')}
  </div>`:''}`;
}

function renderOverlays() {
  const screen=document.getElementById('screen');
  let ov=document.getElementById('success-ov');
  if(state.showSuccess){
    if(!ov){
      ov=document.createElement('div');
      ov.id='success-ov';
      ov.className='full-layer success-ov';
      ov.innerHTML=`<div class="success-card">
        <div style="font-size:58px;margin-bottom:10px">âœ…</div>
        <div style="font-size:22px;font-weight:800;color:#fff;margin-bottom:6px">Viel SpaÃŸ!</div>
        <div style="color:rgba(255,255,255,.45)">${state.selectedMin} Minuten freigeschaltet</div>
      </div>`;
      screen.appendChild(ov);
    }
  } else if(ov) ov.remove();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INTRO PHYSICS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SVG-Pfade fÃ¼r originale App-Icons (weiÃŸ auf transparent)
const _ICON_DEFS = [
  { bg:'#010101', path:`<path fill="white" d="M19.59 6.69a4.83 4.83 0 01-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 01-2.88 2.5 2.89 2.89 0 01-2.89-2.89 2.89 2.89 0 012.89-2.89c.28 0 .54.04.79.1V9.01a6.27 6.27 0 00-.79-.05 6.34 6.34 0 000 12.68 6.34 6.34 0 006.33-6.34V8.69a8.27 8.27 0 004.84 1.55V6.78a4.85 4.85 0 01-1.07-.09z"/>` },
  { bg:'#FF0000', path:`<path fill="white" d="M23.5 6.19a3.02 3.02 0 00-2.13-2.14C19.5 3.67 12 3.67 12 3.67s-7.5 0-9.36.49A3.02 3.02 0 00.5 6.19 31.72 31.72 0 000 12a31.72 31.72 0 00.5 5.81 3.02 3.02 0 002.14 2.14C4.5 20.44 12 20.44 12 20.44s7.5 0 9.36-.49a3.02 3.02 0 002.14-2.14A31.72 31.72 0 0024 12a31.72 31.72 0 00-.5-5.81zM9.75 15.52V8.48L15.86 12l-6.11 3.52z"/>` },
  { bg:'#1877F2', path:`<path fill="white" d="M14 3h-2C10.3 3 9 4.3 9 6v2.5H7V12h2v9h3.5V12H15l.5-3.5H12.5V6.5c0-.3.2-.5.5-.5H15V3h-1z"/>` },
  { bg:'#111111', path:`<path fill="white" d="M19.3 4.5L13.8 11l6.2 8.5h-4.8l-3.5-5.3L8 19.5H3.5l5.8-7.7L3.5 4.5h4.8l3.2 4.8 3.5-4.8z"/>` },
  { bg:'#E50914', path:`<path fill="white" d="M7 3v18l5.5-14.5V21l6.5-18v18H22V3h-3L13 17V3h-3L5 17V3z"/>` },
  { bg:'#FFFC00', path:`<path fill="black" d="M12 3.5C9.2 3.5 7 5.7 7 8.5v.7c-.5.2-.9.7-.9 1.3s.4 1.1.9 1.3c.3 1.5 1.8 2.6 2.1 2.8-.1.4-.3.8-.9 1-.5.1-.7.5-.5.8.8.9 2.4 1.4 3.3 1.4s2.5-.5 3.3-1.4c.2-.3 0-.7-.5-.8-.6-.2-.8-.6-.9-1 .3-.2 1.8-1.3 2.1-2.8.5-.2.9-.7.9-1.3s-.4-1.1-.9-1.3v-.7c0-2.8-2.2-5-5-5z"/>` },
  { bg:'#25D366', path:`<path fill="white" d="M12 2C6.5 2 2 6.5 2 12c0 1.8.5 3.5 1.3 5L2 22l5.2-1.3c1.4.8 3 1.3 4.8 1.3 5.5 0 10-4.5 10-10S17.5 2 12 2zm3.5 13.8c-.2.5-1 .9-1.5 1-.4 0-.8 0-2.4-.5-2-.8-3.3-2.8-3.4-2.9-.1-.2-1-1.3-1-2.5 0-1.1.6-1.7.8-1.9.2-.2.5-.3.7-.3h.4c.2 0 .4.1.5.4l.7 1.7c.1.2 0 .4-.1.5l-.5.6c-.1.1-.2.3-.1.5.4.7 1 1.4 1.7 2 .5.4 1 .7 1.5.9.2.1.4 0 .5-.1l.5-.7c.2-.2.4-.2.6-.1l1.7.8c.2.1.3.2.3.4v.7z"/>` },
  { bg:'#FF4500', path:`<path fill="white" d="M22 12c0-1.1-.9-2-2-2-.5 0-.9.2-1.3.4C17 9.5 15 9 12.8 9l.7-3.5 2.4.5c.1.7.6 1.2 1.3 1.2s1.3-.6 1.3-1.3-.6-1.3-1.3-1.3c-.5 0-1 .3-1.2.7l-2.7-.6c-.2 0-.4.1-.4.3L12 9C9.8 9 7.8 9.5 6.3 10.4 5.9 10.2 5.5 10 5 10c-1.1 0-2 .9-2 2 0 .8.4 1.4 1 1.8-.1.2-.1.5-.1.7 0 2.8 3.6 5 8 5s8-2.2 8-5c0-.2 0-.5-.1-.7.6-.4 1.2-1 1.2-1.8zM8.5 13c.6 0 1 .5 1 1s-.4 1-1 1-1-.5-1-1 .4-1 1-1zm7 2.8c-.7.7-1.8.8-3.5.8s-2.8-.1-3.5-.8c-.2-.2-.2-.4 0-.6.2-.2.4-.2.6 0 .5.5 1.5.7 2.9.7s2.4-.2 2.9-.7c.2-.2.4-.2.6 0 .2.2.2.4 0 .6zm-.5-1.8c-.6 0-1-.5-1-1s.4-1 1-1 1 .5 1 1-.4 1-1 1z"/>` },
  { bg:'#C13584', path:`<path fill="white" d="M12 7.2a4.8 4.8 0 100 9.6 4.8 4.8 0 000-9.6zm0 7.9a3.1 3.1 0 110-6.2 3.1 3.1 0 010 6.2zM17.5 7.5a1.1 1.1 0 11-2.2 0 1.1 1.1 0 012.2 0zM12 3C8.7 3 8.3 3 7.1 3.1c-1.2.1-2 .3-2.7.6-.7.3-1.3.7-1.8 1.2-.5.5-.9 1.1-1.2 1.8-.3.7-.5 1.5-.6 2.7C.8 10.6.8 11 .8 13.2s0 2.6.1 3.8c.1 1.2.3 2 .6 2.7.3.7.7 1.3 1.2 1.8.5.5 1.1.9 1.8 1.2.7.3 1.5.5 2.7.6 1.2.1 1.6.1 3.8.1s2.6 0 3.8-.1c1.2-.1 2-.3 2.7-.6.7-.3 1.3-.7 1.8-1.2.5-.5.9-1.1 1.2-1.8.3-.7.5-1.5.6-2.7.1-1.2.1-1.6.1-3.8s0-2.6-.1-3.8c-.1-1.2-.3-2-.6-2.7-.3-.7-.7-1.3-1.2-1.8-.5-.5-1.1-.9-1.8-1.2-.7-.3-1.5-.5-2.7-.6C14.6 3 14.2 3 12 3zm0 1.6c2.1 0 2.4 0 3.2.1 1 .1 1.5.2 1.8.3.5.2.8.4 1.1.7.3.3.5.6.7 1.1.1.4.2.9.3 1.8.1.9.1 1.1.1 3.2s0 2.4-.1 3.2c-.1 1-.2 1.5-.3 1.8-.2.5-.4.8-.7 1.1-.3.3-.6.5-1.1.7-.4.1-.9.2-1.8.3-.9.1-1.1.1-3.2.1s-2.4 0-3.2-.1c-1-.1-1.5-.2-1.8-.3-.5-.2-.8-.4-1.1-.7-.3-.3-.5-.6-.7-1.1-.1-.4-.2-.9-.3-1.8-.1-.9-.1-1.1-.1-3.2s0-2.4.1-3.2c.1-1 .2-1.5.3-1.8.2-.5.4-.8.7-1.1.3-.3.6-.5 1.1-.7.4-.1.9-.2 1.8-.3.8-.1 1.1-.1 3.2-.1z"/>` },
];
// Icons als Image-Objekte vorlagen (fÃ¼r drawImage auf Canvas)
const APP_ICONS = _ICON_DEFS.map(({bg, path}) => {
  const svg = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">${path}</svg>`;
  const img = new Image();
  img.src = 'data:image/svg+xml,' + encodeURIComponent(svg);
  return { bg, img };
});
const QUESTIONS=[
  'Hast du genug\nvom Scrollen?',
  'Solltest du dich\ngerade nicht konzentrieren?',
  'Wie viele Stunden hast du\nheute schon verschwendet?',
  'Deine Ziele\nwarten noch auf dich.',
  'TikTok wird dich\nnicht weiterbringen.',
  'Was hÃ¤ttest du\nalles erreichen kÃ¶nnen?',
  'Scroll weniger.\nLebe mehr.',
];

let introRunning=false,introAnimId=null,physicsIcons=[],qIdx=0,qTimer=null;

function initIntro(){
  const canvas=document.getElementById('intro-canvas');
  if(!canvas) return;
  const W=362,H=816;
  canvas.width=W; canvas.height=H;

  physicsIcons=[];
  for(let i=0;i<18;i++){
    const ico=APP_ICONS[i%APP_ICONS.length];
    physicsIcons.push({
      x:Math.random()*(W-60)+10,y:-(Math.random()*H*1.5+50),
      vx:(Math.random()-.5)*0.6,vy:Math.random()*0.6+0.2,
      rot:Math.random()*Math.PI*2,av:(Math.random()-.5)*0.03,
      size:Math.random()*14+46,ico,bounces:0,
    });
  }
  introRunning=true;
  animateIntro();
  showQ(0);
}

function animateIntro(){
  if(!introRunning) return;
  const canvas=document.getElementById('intro-canvas');
  if(!canvas) return;
  const ctx=canvas.getContext('2d');
  const W=canvas.width,H=canvas.height;
  ctx.clearRect(0,0,W,H);

  physicsIcons.forEach(p=>{
    p.vy+=0.12; p.x+=p.vx; p.y+=p.vy; p.rot+=p.av;
    if(p.y+p.size>H&&p.bounces<5){
      p.y=H-p.size; p.vy=-Math.abs(p.vy)*0.42; p.vx*=0.62; p.av*=0.7; p.bounces++;
    }
    if(p.x<0){p.x=0;p.vx=Math.abs(p.vx)*0.6;}
    if(p.x+p.size>W){p.x=W-p.size;p.vx=-Math.abs(p.vx)*0.6;}

    ctx.save();
    ctx.translate(p.x+p.size/2,p.y+p.size/2);
    ctx.rotate(p.rot);
    const r=p.size*.22,s=p.size,h=s/2;
    ctx.shadowColor='rgba(0,0,0,0.6)';ctx.shadowBlur=12;ctx.shadowOffsetY=5;
    ctx.fillStyle=p.ico.bg;
    ctx.beginPath();ctx.roundRect(-h,-h,s,s,r);ctx.fill();
    ctx.shadowColor='transparent';
    if(p.ico.img && p.ico.img.complete){
      ctx.drawImage(p.ico.img,-h*0.65,-h*0.65,s*0.65,s*0.65);
    }
    ctx.restore();
  });

  physicsIcons.forEach((p,i)=>{
    if(p.bounces>=5&&Math.abs(p.vy)<0.5){
      const ico=APP_ICONS[Math.floor(Math.random()*APP_ICONS.length)];
      physicsIcons[i]={x:Math.random()*(W-60)+10,y:-Math.random()*120-60,vx:(Math.random()-.5)*0.6,vy:Math.random()*0.4+0.2,rot:Math.random()*Math.PI*2,av:(Math.random()-.5)*0.03,size:Math.random()*14+46,ico,bounces:0};
    }
  });
  introAnimId=requestAnimationFrame(animateIntro);
}

function showQ(idx){
  const el=document.getElementById('intro-question');
  if(!el) return;
  el.style.opacity='0';
  setTimeout(()=>{el.innerHTML=QUESTIONS[idx].replace('\n','<br>');el.style.opacity='1';},400);
  qTimer=setTimeout(()=>showQ((idx+1)%QUESTIONS.length),3200);
}

function exitIntro(){
  introRunning=false;
  cancelAnimationFrame(introAnimId);
  clearTimeout(qTimer);
  const layer=document.getElementById('intro-layer');
  const sl=document.getElementById('stats-layer');

  // Stats-Layer bereit machen (unten, unsichtbar)
  sl.style.display='block';
  sl.style.opacity='0';
  sl.style.transform='translateY(60px)';
  sl.style.transition='none';

  // Gleichzeitig: Intro raus, Stats rein
  requestAnimationFrame(()=>{
    layer.style.transition='opacity .45s ease';
    layer.style.opacity='0';
    sl.style.transition='opacity .5s ease, transform .5s cubic-bezier(0.22,1,0.36,1)';
    sl.style.opacity='1';
    sl.style.transform='translateY(0)';
  });

  setTimeout(()=>{ layer.style.display='none'; }, 500);
}

function exitStats(){
  const sl=document.getElementById('stats-layer');
  sl.style.transition='opacity .4s ease';
  sl.style.opacity='0';
  setTimeout(()=>{
    sl.style.display='none';
    document.getElementById('reg-layer').style.display='flex';
  },400);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  BOOT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
render();
initIntro();
</script>
</body>
</html>
